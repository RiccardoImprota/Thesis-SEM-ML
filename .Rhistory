filter(across(all_of(variablestopredict), any_vars(!is.na(.))))
# Check summaries again for 'seniority' and 'predict_earnings' variables to compare with previous scripts
summary(df$seniority)
summary(df$predict_earnings)
# Visualize potential outliers with a boxplot
boxplot(df$age, df$seniority, df$usual_hours_week, names = c("age", "seniority", "usual_hours_week"),
main = "Boxplot of selected numerical Variables",
xlab = " ",
ylab = "Value")
# Define a function to remove extreme outliers (those that fall outside a specified number of standard deviations from the mean)
remove_extreme_outliers <- function(df, threshold = 4) {
# Store original number of rows
original_nrow <- nrow(df)
# Iterate over all numeric columns
df <- df %>%
mutate(across(where(is.numeric),
list(outlier = ~ifelse(is.na(.), NA, abs((. - mean(., na.rm = TRUE)) / sd(., na.rm = TRUE)) <= threshold)),
.names = "{.col}_outlier")) %>%
filter(if_all(ends_with("_outlier"), ~is.na(.) | .)) %>%
select(-ends_with("_outlier"))
# Calculate and print number of rows removed
removed_rows <- original_nrow - nrow(df)
print(paste("Removed", removed_rows, "rows"))
return(df)
}
df <- remove_extreme_outliers(df)
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "steelblue") +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "steelblue") +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1),plot.title = element_text(hjust = 0.5)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "steelblue") +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.8)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black") +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.2)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.6) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.2)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 2,vjust = 1)) + theme_minimal()
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme_void() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
xlim(0, 1192) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
nrow(df)
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
coord_cartesian(xlim = c(0, 1192)) +
xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
coord_cartesian(xlim = c(0, 1192)) +
#  xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
coord_cartesian(xlim = c(0, 1192)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(limits = c(0, 1192), breaks = seq(0, 1192, by = 100)) +  # Enforce limits and custom breaks
coord_cartesian(clip = "off") +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(limits = c(0, 1192), breaks = seq(0, 1192, by = 100)) +  # Enforce limits and custom breaks
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(limits = c(0, 1192), breaks = seq(0, 1192, by = 200)) +  # Enforce limits and custom breaks
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(limits = c(0, 1192), breaks = seq(0, 1192, by = 300)) +  # Enforce limits and custom breaks
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)-100) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)-50) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)-40) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = max(1, nrow(df)/10))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
max(1, nrow(df)/10)
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = max(1, nrow(df)/5))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
scale_x_continuous(breaks = seq(0, nrow(df), by = max(1, nrow(df)/5))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
scale_x_continuous(breaks = seq(0, nrow(df), by = 200)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
scale_x_continuous(breaks = seq(0, nrow(df), by = 200)) +
coord_cartesian(xlim = 0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
coord_cartesian(xlim = 500) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
scale_x_continuous(breaks = seq(0, max(na_count$value, na.rm = TRUE), by = 200)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
xlim(0, nrow(df)) +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = round(nrow(df)/10)), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = 200)), limits = c(0, nrow(df))) +
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = 200), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = round(nrow(df)/10)), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = round(nrow(df)/5)), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
get_breaks <- function(max_val) {
# Get basic sequence
breaks <- seq(0, max_val, by = round(max_val/10))
# Adjust last value to be max_val if it's not already in the sequence
if (breaks[length(breaks)] != max_val) {
breaks[length(breaks)] <- max_val
}
return(breaks)
}
get_breaks(1192)
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = round(nrow(df)/4)), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = 300)), limits = c(0, nrow(df))) +
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = 300), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = seq(0, nrow(df), by = 200), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
# Get the count of NA values for each column in your dataframe
na_count <- df %>% summarise_all(function(x) sum(is.na(x)))
na_count <- na_count %>% pivot_longer(cols = everything(), names_to = "variable", values_to = "value")
# Create histogram
ggplot(na_count, aes(x = value, y = reorder(variable, value))) +
geom_bar(stat = "identity", width = 0.5, fill = "black", alpha=0.7) +
labs(title = "Distribution of Missing Values",
x = "Count of NA", y = "Variable") +
scale_x_continuous(breaks = c(300, 600, 900, 1192), limits = c(0, nrow(df))) +
theme_minimal() +
theme(axis.text.y = element_text(angle = 0, hjust = 1), plot.title = element_text(hjust = 0.5,vjust = 1))
